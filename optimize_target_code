ASSUME CS:CODE, DS:DATA, SS:STACK
 DATA SEGMENT
   global DW 0
   DW 0
   DW 0
   DW 0
   DW 0
   DW 0
   DW 0
   DW 0
   DW 0
 DATA ENDS
 STACK SEGMENT
  DW 200 DUP(0)
 STACK ENDS
 CODE SEGMENT
  MOV AX, DATA
  MOV DS, AX
  MOV AX, 1
  MOV WORD PTR DS:[0], AX
  MOV AX, WORD PTR SS:[BP - 0]
  MOV WORD PTR DS:[0], AX
MAIN:
L9:
  MOV AX, 20
  MOV WORD PTR DS:[2], AX
  CALL FAR PTR sum
  MOV WORD PTR SS:[BP - 44], AX
  JMP L8
L10:
  JMP
  CALL FAR PTR fact
  MOV WORD PTR SS:[BP - 46], AX
  JMP L8
L11:
  JMP L8
L8:
  MOV AX, 0
  MOV WORD PTR DS:[2], AX
  CALL FAR PTR do_while
  MOV WORD PTR SS:[BP - 48], AX
  JMP L12
L13:
  MOV AX, 4C00H
  INT 21H

sum PROC FAR
  PUSH BP
  MOV BP, SP
  MOV AX, WORD PTR DS:[2]
  MOV WORD PTR SS:[BP - 0], AX
L0:
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 0
  CMP AX, BX
  PUSHF
  POP AX
  TEST AX, 0041H
  PUSHF
  POP AX
  AND AX, 0040H
  MOV WORD PTR SS:[BP - 4], AX
  MOV AX, WORD PTR SS:[BP - 4]
  CMP AX, 0
  JNE L1

  MOV BX, WORD PTR SS:[BP - 0]
  ADD AX, BX
  MOV WORD PTR SS:[BP - 2], AX
  MOV WORD PTR DS:[2], AX
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 1
  SUB AX, BX
  MOV WORD PTR SS:[BP - 0], AX
  MOV WORD PTR DS:[0], AX
  JMP L0
L1:
  MOV SP, BP
  POP BP
  RET
sum ENDP

fact PROC FAR
  PUSH BP
  MOV BP, SP
  MOV AX, WORD PTR DS:[2]
  MOV WORD PTR SS:[BP - 0], AX
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 0
  CMP AX, BX
  PUSHF
  POP AX
  AND AX, 0040H
  MOV WORD PTR SS:[BP - 2], AX
  MOV AX, WORD PTR SS:[BP - 2]
  CMP AX, 0
  JNE L2
  MOV SP, BP
  POP BP
  RET
fact ENDP

do_while PROC FAR
  PUSH BP
  MOV BP, SP
  MOV AX, WORD PTR DS:[2]
  MOV WORD PTR SS:[BP - 0], AX
L4:
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 5
  CMP AX, BX
  PUSHF
  POP AX
  AND AX, 0040H
  MOV WORD PTR SS:[BP - 4], AX
  MOV AX, WORD PTR SS:[BP - 4]
  CMP AX, 0
  JNE L6
  JMP L4
L6:

  MOV BX, WORD PTR SS:[BP - 0]
  ADD AX, BX
  MOV WORD PTR SS:[BP - 2], AX
  MOV WORD PTR DS:[2], AX
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 1
  SUB AX, BX
  MOV WORD PTR SS:[BP - 0], AX
  MOV WORD PTR DS:[0], AX
  MOV AX, WORD PTR SS:[BP - 0]
  MOV BX, 0
  CMP AX, BX
  PUSHF
  POP AX
  TEST AX, 0041H
  PUSHF
  POP AX
  AND AX, 0040H
  MOV WORD PTR SS:[BP - 6], AX
  MOV AX, WORD PTR SS:[BP - 6]
  CMP AX, 0
  JNE L5
  JMP L4
L5:
  MOV SP, BP
  POP BP
  RET
do_while ENDP
 CODE ENDS
END